<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UI Polish and Visual Effects Test</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #000;
            color: #00ff00;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .test-section {
            background: rgba(0, 50, 0, 0.2);
            border: 1px solid #00aa00;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .test-section h2 {
            color: #00ff00;
            margin-top: 0;
            border-bottom: 1px solid #00aa00;
            padding-bottom: 10px;
        }
        
        .button-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .test-button {
            background: #003300;
            border: 2px solid #00aa00;
            color: #00ff00;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-family: inherit;
            font-size: 14px;
            transition: all 0.2s ease;
        }
        
        .test-button:hover {
            background: #004400;
            border-color: #00ff00;
        }
        
        .test-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .combat-demo {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .character-card {
            background: rgba(0, 100, 0, 0.2);
            border: 2px solid #00aa00;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            position: relative;
        }
        
        .character-name {
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .hp-bar {
            background: #333;
            height: 20px;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
            position: relative;
        }
        
        .hp-fill {
            background: linear-gradient(90deg, #ff0000, #ffff00, #00ff00);
            height: 100%;
            width: 80%;
            transition: width 0.5s ease;
        }
        
        .hp-text {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: bold;
        }
        
        .status-log {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #333;
            border-radius: 5px;
            padding: 15px;
            height: 200px;
            overflow-y: auto;
            font-size: 12px;
            line-height: 1.4;
        }
        
        .log-entry {
            margin-bottom: 5px;
            padding: 2px 0;
        }
        
        .log-entry.success {
            color: #00ff00;
        }
        
        .log-entry.error {
            color: #ff4444;
        }
        
        .log-entry.info {
            color: #00aaff;
        }
        
        .controls-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .control-group {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid #333;
            border-radius: 5px;
            padding: 15px;
        }
        
        .control-group h4 {
            margin: 0 0 10px 0;
            color: #00aa00;
        }
        
        .slider-container {
            margin: 10px 0;
        }
        
        .slider-label {
            display: block;
            margin-bottom: 5px;
            font-size: 12px;
        }
        
        .slider {
            width: 100%;
            height: 5px;
            border-radius: 5px;
            background: #333;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: #00ff00;
            cursor: pointer;
        }
        
        .enhancement-level {
            display: flex;
            gap: 10px;
            margin: 10px 0;
        }
        
        .level-btn {
            background: #333;
            border: 1px solid #666;
            color: #ccc;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 11px;
        }
        
        .level-btn.active {
            background: #00aa00;
            border-color: #00ff00;
            color: #000;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>UI Polish and Visual Effects Test</h1>
        
        <div class="test-section">
            <h2>UI Polish System</h2>
            <p>Test smooth animations, hover effects, and interactive feedback.</p>
            
            <div class="button-grid">
                <button class="test-button" onclick="testButtonFeedback(this)">Normal Button</button>
                <button class="test-button" onclick="testLoadingState(this)">Loading Test</button>
                <button class="test-button" onclick="testSuccessFeedback(this)">Success Test</button>
                <button class="test-button" onclick="testErrorFeedback(this)">Error Test</button>
                <button class="test-button" disabled>Disabled Button</button>
                <button class="test-button" onclick="testConfirmation()">Confirmation Dialog</button>
                <button class="test-button" onclick="testNotification('success')">Success Notification</button>
                <button class="test-button" onclick="testNotification('error')">Error Notification</button>
            </div>
        </div>
        
        <div class="test-section">
            <h2>Visual Effects System</h2>
            <p>Test particle effects, screen effects, and combat animations.</p>
            
            <div class="combat-demo">
                <div class="character-card" data-combatant-id="player-1">
                    <div class="character-name">Hero</div>
                    <div class="hp-bar">
                        <div class="hp-fill"></div>
                        <div class="hp-text">80/100 HP</div>
                    </div>
                    <button class="test-button" onclick="testDamageEffect('player-1')">Take Damage</button>
                    <button class="test-button" onclick="testHealingEffect('player-1')">Heal</button>
                </div>
                
                <div class="character-card" data-combatant-id="enemy-1">
                    <div class="character-name">Goblin</div>
                    <div class="hp-bar">
                        <div class="hp-fill" style="width: 60%;"></div>
                        <div class="hp-text">60/100 HP</div>
                    </div>
                    <button class="test-button" onclick="testSkillEffect('fire')">Fire Attack</button>
                    <button class="test-button" onclick="testSkillEffect('ice')">Ice Attack</button>
                </div>
            </div>
            
            <div class="button-grid">
                <button class="test-button" onclick="testScreenEffect('flash')">Screen Flash</button>
                <button class="test-button" onclick="testScreenEffect('shake')">Screen Shake</button>
                <button class="test-button" onclick="testLevelUpEffect()">Level Up Effect</button>
                <button class="test-button" onclick="testCriticalHit()">Critical Hit</button>
                <button class="test-button" onclick="testVictoryEffect()">Victory Effect</button>
                <button class="test-button" onclick="testStatusEffect()">Status Effect</button>
            </div>
        </div>
        
        <div class="test-section">
            <h2>Audio System</h2>
            <p>Test synthesized audio feedback and sound effects.</p>
            
            <div class="button-grid">
                <button class="test-button" onclick="testAudio('buttonClick')">Button Click</button>
                <button class="test-button" onclick="testAudio('attack')">Attack Sound</button>
                <button class="test-button" onclick="testAudio('fireball')">Fireball</button>
                <button class="test-button" onclick="testAudio('heal')">Healing</button>
                <button class="test-button" onclick="testAudio('levelUp')">Level Up</button>
                <button class="test-button" onclick="testAudio('success')">Success</button>
                <button class="test-button" onclick="testAudio('error')">Error</button>
                <button class="test-button" onclick="testAudio('criticalHit')">Critical Hit</button>
            </div>
        </div>
        
        <div class="test-section">
            <h2>System Controls</h2>
            
            <div class="controls-section">
                <div class="control-group">
                    <h4>Enhancement Level</h4>
                    <div class="enhancement-level">
                        <button class="level-btn" onclick="setEnhancementLevel('minimal')">Minimal</button>
                        <button class="level-btn" onclick="setEnhancementLevel('standard')">Standard</button>
                        <button class="level-btn active" onclick="setEnhancementLevel('full')">Full</button>
                    </div>
                </div>
                
                <div class="control-group">
                    <h4>Audio Settings</h4>
                    <div class="slider-container">
                        <label class="slider-label">Master Volume</label>
                        <input type="range" class="slider" min="0" max="100" value="70" 
                               onchange="setMasterVolume(this.value)">
                    </div>
                    <div class="slider-container">
                        <label class="slider-label">SFX Volume</label>
                        <input type="range" class="slider" min="0" max="100" value="80" 
                               onchange="setSFXVolume(this.value)">
                    </div>
                </div>
                
                <div class="control-group">
                    <h4>System Status</h4>
                    <button class="test-button" onclick="showSystemStatus()">Show Status</button>
                    <button class="test-button" onclick="clearEffects()">Clear Effects</button>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>Event Log</h2>
            <div class="status-log" id="eventLog">
                <div class="log-entry info">UI Enhancement Manager initialized</div>
                <div class="log-entry info">Ready for testing...</div>
            </div>
        </div>
    </div>

    <script type="module">
        import { uiEnhancementManager } from './src/engine/ui/UIEnhancementManager.js';
        
        // Global reference for testing
        window.uiManager = uiEnhancementManager;
        
        // Initialize the UI enhancement manager
        async function initializeManager() {
            const success = await uiEnhancementManager.initialize({
                enhancementLevel: 'full'
            });
            
            if (success) {
                logEvent('UI Enhancement Manager initialized successfully', 'success');
            } else {
                logEvent('Failed to initialize UI Enhancement Manager', 'error');
            }
        }
        
        // Test functions
        window.testButtonFeedback = function(button) {
            logEvent('Button feedback test triggered', 'info');
            uiManager.showSuccess(button, 'Button clicked successfully!');
        };
        
        window.testLoadingState = function(button) {
            logEvent('Loading state test started', 'info');
            uiManager.showLoading(button, 'Processing');
            
            setTimeout(() => {
                uiManager.hideLoading(button);
                logEvent('Loading state test completed', 'success');
            }, 2000);
        };
        
        window.testSuccessFeedback = function(button) {
            uiManager.showSuccess(button, 'Operation completed successfully!');
            logEvent('Success feedback displayed', 'success');
        };
        
        window.testErrorFeedback = function(button) {
            uiManager.showError(button, 'An error occurred!');
            logEvent('Error feedback displayed', 'error');
        };
        
        window.testConfirmation = function() {
            uiManager.showConfirmation(
                'Are you sure you want to proceed?',
                () => logEvent('Confirmation accepted', 'success'),
                () => logEvent('Confirmation cancelled', 'info')
            );
        };
        
        window.testNotification = function(type) {
            const messages = {
                success: 'Operation completed successfully!',
                error: 'An error has occurred!',
                warning: 'This is a warning message.',
                info: 'This is an informational message.'
            };
            
            uiManager.showNotification(messages[type] || messages.info, type);
            logEvent(`${type} notification shown`, type);
        };
        
        window.testDamageEffect = function(targetId) {
            const damageData = {
                target: { id: targetId },
                damage: 25,
                damageType: 'physical',
                isCritical: false
            };
            
            // Trigger damage effect
            window.dispatchEvent(new CustomEvent('combatEvent', {
                detail: {
                    type: 'damageDealt',
                    data: damageData
                }
            }));
            
            logEvent(`Damage effect triggered on ${targetId}`, 'info');
        };
        
        window.testHealingEffect = function(targetId) {
            const healData = {
                target: { id: targetId },
                healing: 20
            };
            
            // Trigger healing effect
            window.dispatchEvent(new CustomEvent('combatEvent', {
                detail: {
                    type: 'healingApplied',
                    data: healData
                }
            }));
            
            logEvent(`Healing effect triggered on ${targetId}`, 'success');
        };
        
        window.testSkillEffect = function(element) {
            const skillData = {
                caster: { id: 'player-1' },
                skill: { element: element },
                targets: [{ id: 'enemy-1' }]
            };
            
            // Trigger skill effect
            window.dispatchEvent(new CustomEvent('combatEvent', {
                detail: {
                    type: 'skillUsed',
                    data: skillData
                }
            }));
            
            logEvent(`${element} skill effect triggered`, 'info');
        };
        
        window.testScreenEffect = function(effectType) {
            if (uiManager.effectsSystem && uiManager.effectsSystem.isInitialized) {
                uiManager.effectsSystem.playScreenEffect(effectType);
                logEvent(`Screen ${effectType} effect triggered`, 'info');
            } else {
                logEvent('Visual effects system not available', 'error');
            }
        };
        
        window.testLevelUpEffect = function() {
            const levelUpData = {
                character: { id: 'player-1', name: 'Hero' },
                newLevel: 5
            };
            
            // Trigger level up effect
            window.dispatchEvent(new CustomEvent('levelUp', {
                detail: levelUpData
            }));
            
            logEvent('Level up effect triggered', 'success');
        };
        
        window.testCriticalHit = function() {
            const critData = {
                target: { id: 'enemy-1' },
                damage: 45,
                isCritical: true
            };
            
            // Trigger critical hit effect
            window.dispatchEvent(new CustomEvent('combatEvent', {
                detail: {
                    type: 'criticalHit',
                    data: critData
                }
            }));
            
            logEvent('Critical hit effect triggered', 'success');
        };
        
        window.testVictoryEffect = function() {
            const victoryData = {
                result: 'victory'
            };
            
            // Trigger victory effect
            window.dispatchEvent(new CustomEvent('combatEvent', {
                detail: {
                    type: 'combatEnded',
                    data: victoryData
                }
            }));
            
            logEvent('Victory effect triggered', 'success');
        };
        
        window.testStatusEffect = function() {
            const statusData = {
                target: { id: 'player-1' },
                effect: {
                    type: 'buff',
                    name: 'Strength Boost',
                    duration: 3,
                    category: 'buff'
                }
            };
            
            // Trigger status effect
            window.dispatchEvent(new CustomEvent('combatEvent', {
                detail: {
                    type: 'statusApplied',
                    data: statusData
                }
            }));
            
            logEvent('Status effect applied', 'info');
        };
        
        window.testAudio = function(soundName) {
            if (uiManager.audioSystem && uiManager.audioSystem.isInitialized) {
                uiManager.audioSystem.playSound(soundName);
                logEvent(`Audio: ${soundName}`, 'info');
            } else {
                logEvent(`[Audio] ${soundName} (system not available)`, 'info');
            }
        };
        
        window.setEnhancementLevel = function(level) {
            uiManager.setEnhancementLevel(level);
            
            // Update button states
            document.querySelectorAll('.level-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            logEvent(`Enhancement level set to ${level}`, 'info');
        };
        
        window.setMasterVolume = function(value) {
            const volume = value / 100;
            if (uiManager.audioSystem && uiManager.audioSystem.isInitialized) {
                uiManager.audioSystem.setMasterVolume(volume);
                logEvent(`Master volume set to ${value}%`, 'info');
            }
        };
        
        window.setSFXVolume = function(value) {
            const volume = value / 100;
            if (uiManager.audioSystem && uiManager.audioSystem.isInitialized) {
                uiManager.audioSystem.setSFXVolume(volume);
                logEvent(`SFX volume set to ${value}%`, 'info');
            }
        };
        
        window.showSystemStatus = function() {
            const status = uiManager.getStatus();
            console.log('UI Enhancement Manager Status:', status);
            
            logEvent('System status logged to console', 'info');
            logEvent(`Enhancement Level: ${status.enhancementLevel}`, 'info');
            logEvent(`Frame Rate: ${status.performance.frameRate.toFixed(1)} FPS`, 'info');
        };
        
        window.clearEffects = function() {
            // Clear any active effects
            if (uiManager.effectsSystem && uiManager.effectsSystem.isInitialized) {
                // Remove any status indicators
                document.querySelectorAll('.status-indicator').forEach(el => el.remove());
                document.querySelectorAll('.aura-effect').forEach(el => el.remove());
            }
            
            logEvent('Visual effects cleared', 'info');
        };
        
        function logEvent(message, type = 'info') {
            const log = document.getElementById('eventLog');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
            
            // Keep only last 50 entries
            const entries = log.querySelectorAll('.log-entry');
            if (entries.length > 50) {
                entries[0].remove();
            }
        }
        
        // Initialize when page loads
        initializeManager();
    </script>
</body>
</html>