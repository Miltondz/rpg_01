{
  "id": "crypt-of-shadows-floor-4",
  "name": "Crypt of Shadows - Floor 4",
  "width": 18,
  "height": 18,
  "spawn": {
    "x": 1,
    "z": 1,
    "direction": 0
  },
  "tiles": [
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    2, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2,
    2, 1, 2, 2, 2, 2, 1, 2, 1, 1, 2, 1, 2, 2, 2, 2, 1, 2,
    2, 1, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 2,
    2, 1, 2, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 2, 1, 2,
    2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2,
    2, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 2,
    2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2,
    2, 2, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 2, 2,
    2, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 2,
    2, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 2,
    2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2,
    2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2,
    2, 1, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 1, 2,
    2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2,
    2, 1, 2, 2, 2, 2, 1, 2, 1, 1, 2, 1, 2, 2, 2, 2, 1, 2,
    2, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 1, 1, 1, 1, 1, 3, 2,
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2
  ],
  "doors": [
    {
      "x": 7,
      "z": 1,
      "orientation": "vertical",
      "locked": false,
      "keyType": null
    },
    {
      "x": 10,
      "z": 1,
      "orientation": "vertical",
      "locked": false,
      "keyType": null
    },
    {
      "x": 5,
      "z": 6,
      "orientation": "horizontal",
      "locked": true,
      "keyType": "master"
    },
    {
      "x": 12,
      "z": 6,
      "orientation": "horizontal",
      "locked": true,
      "keyType": "master"
    },
    {
      "x": 8,
      "z": 8,
      "orientation": "vertical",
      "locked": true,
      "keyType": "ancient"
    },
    {
      "x": 9,
      "z": 8,
      "orientation": "vertical",
      "locked": true,
      "keyType": "ancient"
    }
  ],
  "transitions": [
    {
      "x": 16,
      "z": 16,
      "type": "stairs",
      "target": "crypt-of-shadows-floor-5",
      "spawn": {
        "x": 1,
        "z": 1,
        "direction": 0
      }
    }
  ],
  "safeZones": [
    {
      "x": 9,
      "z": 9,
      "type": "sanctum",
      "name": "Ancient Sanctum",
      "description": "A powerful sanctum that offers advanced services to worthy adventurers",
      "services": ["save", "heal", "shop", "upgrade", "enchant"],
      "healAmount": 100,
      "cooldown": 0,
      "shopInventory": [
        { "itemId": "health_potion_large", "stock": 3, "price": 100 },
        { "itemId": "health_potion_full", "stock": 2, "price": 200 },
        { "itemId": "elixir_of_power", "stock": 2, "price": 150 },
        { "itemId": "phoenix_feather", "stock": 1, "price": 300 },
        { "itemId": "mythril_sword", "stock": 1, "price": 800 },
        { "itemId": "dragon_scale_armor", "stock": 1, "price": 750 },
        { "itemId": "master_ring", "stock": 1, "price": 500 }
      ]
    }
  ],
  "scriptedEncounters": [
    {
      "x": 8,
      "z": 4,
      "id": "lich_lieutenant",
      "type": "mini_boss",
      "oneTime": true,
      "enemies": [
        { "type": "lich_lieutenant", "level": 8 }
      ],
      "rewards": {
        "experience": 200,
        "gold": { "min": 80, "max": 120 },
        "loot": [
          { "itemId": "ancient_key", "chance": 1.0, "quantity": { "min": 2, "max": 2 } },
          { "itemId": "lich_staff", "chance": 0.7, "quantity": { "min": 1, "max": 1 } }
        ]
      }
    },
    {
      "x": 3,
      "z": 14,
      "id": "shadow_legion",
      "type": "scripted",
      "oneTime": true,
      "enemies": [
        { "type": "shadow_beast", "level": 6 },
        { "type": "shadow_beast", "level": 6 },
        { "type": "undead_knight", "level": 7 }
      ],
      "rewards": {
        "experience": 180,
        "gold": { "min": 70, "max": 100 }
      }
    },
    {
      "x": 14,
      "z": 3,
      "id": "ancient_guardian",
      "type": "scripted",
      "oneTime": true,
      "enemies": [
        { "type": "ancient_golem", "level": 9 }
      ],
      "rewards": {
        "experience": 150,
        "gold": { "min": 60, "max": 90 },
        "loot": [
          { "itemId": "golem_core", "chance": 0.8, "quantity": { "min": 1, "max": 1 } }
        ]
      }
    }
  ],
  "keyItems": [
    {
      "x": 5,
      "z": 12,
      "itemId": "ancient_key",
      "respawn": false
    },
    {
      "x": 12,
      "z": 12,
      "itemId": "ancient_key",
      "respawn": false
    }
  ],
  "lootChests": [
    {
      "x": 3,
      "z": 3,
      "loot": [
        { "itemId": "health_potion_full", "chance": 0.9, "quantity": { "min": 1, "max": 2 } },
        { "itemId": "mythril_sword", "chance": 0.7, "quantity": { "min": 1, "max": 1 } }
      ]
    },
    {
      "x": 14,
      "z": 14,
      "loot": [
        { "itemId": "elixir_of_power", "chance": 0.8, "quantity": { "min": 1, "max": 1 } },
        { "itemId": "dragon_scale_armor", "chance": 0.6, "quantity": { "min": 1, "max": 1 } }
      ]
    },
    {
      "x": 6,
      "z": 9,
      "loot": [
        { "itemId": "ancient_tome", "chance": 0.7, "quantity": { "min": 1, "max": 1 } },
        { "itemId": "wisdom_amulet", "chance": 0.5, "quantity": { "min": 1, "max": 1 } }
      ]
    },
    {
      "x": 11,
      "z": 9,
      "loot": [
        { "itemId": "phoenix_feather", "chance": 0.6, "quantity": { "min": 1, "max": 1 } },
        { "itemId": "master_ring", "chance": 0.4, "quantity": { "min": 1, "max": 1 } }
      ]
    }
  ],
  "advancedMechanics": [
    {
      "x": 9,
      "z": 5,
      "type": "teleporter",
      "description": "An ancient teleportation circle",
      "destination": { "x": 9, "z": 13 },
      "requirement": "ancient_key",
      "bidirectional": true
    },
    {
      "x": 5,
      "z": 9,
      "type": "magic_barrier",
      "description": "A shimmering barrier blocks the path",
      "requirement": "defeat_lich_lieutenant",
      "effect": "permanent_removal"
    }
  ],
  "elitePatrols": [
    {
      "path": [
        { "x": 3, "z": 3 },
        { "x": 6, "z": 3 },
        { "x": 6, "z": 6 },
        { "x": 3, "z": 6 }
      ],
      "enemy": { "type": "shadow_patrol", "level": 7 },
      "patrolSpeed": 2000,
      "detectionRange": 2,
      "respawnTime": 300000
    }
  ]
}